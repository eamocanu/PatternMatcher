old style implementation - not used anymore, but kept for historical reasons